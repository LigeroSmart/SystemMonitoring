<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
    "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">

<book lang="en">

<!--
************************************** Head ***********************************************
-->
<bookinfo>
    <title>$Name</title>
    <edition>$Description Version $Version</edition>
    <copyright>
        <year>$YearStamp</year>
        <holder>$Vendor, $URL</holder>
    </copyright>
    <date>$DateStamp</date>
    <legalnotice>
        <para>$License</para>
        <para>
            This work is copyrighted by $Vendor, Norsk-Data-Str. 1, 61352 Bad Homburg, Germany.
        </para>
        <para>Build Date: $DateStamp</para>
    </legalnotice>
</bookinfo>

<!--
************************************ Customer part ******************************************
-->

<!-- ********** -->
<!-- 1. Preface -->
<!-- ********** -->
<preface id="preface">
    <title>Preface</title>
        <para>
            This module implements a basic interface to System Monitoring Suites. It
            works by receiving email messages sent by a Network Monitoring Suite. New
            tickets are created in case of component failures. Once a ticket has
            been opened messages regarding the effected component are attached to
            this ticket. When the component recovers, the ticket state can be
            changed or the ticket can be closed.
        </para>
        <para>
            If an open ticket for a given Host/Service combination exists, all
            mails concerning this particular combination will be attached to the
            ticket until it's closed.
        </para>

    <para>
        If you have questions regarding this package, please contact your support team
        <ulink url="mailto:support@otrs.com?subject=$Name">
            &lt;support@otrs.com&gt;
        </ulink> for more information.
    </para>
</preface>

<!-- *************** -->
<!-- 2. Feature List -->
<!-- *************** -->
<chapter>
    <title>Feature List</title>
    <!--
        List of all functions declared at the functional level
         -   minimum in 4 sentences
         -   customer-specific
         -   possible screenshots
         -   no OTRS terminology like TicketEventModul, PreApplicationModul
    -->
    <section>
        <title>Control flow</title>
        <para>
            The following diagram illustrates how mails are handled by this module
            and in which cases they trigger which action. Pretty much all checks are
            configurable using the regular expressions given by the parameters listed
            above.
        </para>
<para><screen><![CDATA[
Mail matches 'FromAddress'?
|
+-> NO  --> Continue with regular mail processing
|
+-> YES --> Does a ticket with matching Host/Service combination
            already exist in OTRS?
            |
            +-> NO  -> Does 'State:' match 'NewTicketRegExp'?
            |          |
            |          +-> NO  -> Stop processing this mail
            |          |          (silent drop)
            |          |
            |          +-> YES -> Create new ticket, record Host
            |                     and Service, attach mail
            |
            +-> YES -> Attach mail to ticket
                    -> Does 'State:' match 'CloseTicketRegExp'?
                        |
                        +-> NO  -> Continue with regular mail processing
                        |
                        +-> YES -> Change ticket type as configured in
                                    'CloseActionState']]>
</screen></para>
        <para>Besides of a few additional sanity checks this is how the
            SystemMonitoring module treats incoming mails. By changing the regular
            expressions it should be possible to adopt it to different monitoring
            systems.
        </para>
    </section>
</chapter>

<!-- ********************** -->
<!-- 3. System Requirements -->
<!-- ********************** -->
<chapter>
    <title>System Requirements</title>
    <section>
        <title>Framework</title>
        <para>The following OTRS framework is required:</para>
        <para>$Framework</para>
    </section>
    <section>
        <title>Packages</title>
        <para>The following packages are required:</para>
        <para>$PackageRequired</para>
    </section>
    <section>
        <title>Operating System</title>
        <para>This package requires one of the following operating systems:</para>
        <para>$OS</para>
    </section>
    <section>
        <title>Third Party Software</title>
        <para>This third party software is required to use this package:</para>
        <itemizedlist>
            <listitem>
                <para>
                    A network monitoring system, such as Nagios, or HP OpenView,
                    or similar, capable of sending out events via e-mail.
                </para>
            </listitem>
        </itemizedlist>
    </section>
</chapter>

<!-- *************** -->
<!-- 4. Installation -->
<!-- *************** -->
<chapter>
    <title>Installation</title>
    <para>
        The following instructions explain how to install the package.
    </para>
    <section>
        <title>Admin Interface</title>
        <para>
            Please use the following URL to install the package utilizing the Admin Interface
            (please note that you need to be in the "admin" group).
        </para>
        <para>
            <ulink url="http://localhost/otrs/index.pl?Action=AdminPackageManager">
                http://localhost/otrs/index.pl?Action=AdminPackageManager
            </ulink>
        </para>
    </section>
    <section>
        <title>Command Line</title>
        <para>
            Whenever you cannot use the Admin Interface for whatever reason, you may use the
            following command line tool ("bin/otrs.PackageManager.pl") instead.
        </para>
        <para>
            <screen>
shell> bin/otrs.PackageManager.pl -a install -p /path/to/$Name-$Version.opm
            </screen>
        </para>
    </section>
</chapter>

<!-- **************** -->
<!-- 5. Configuration -->
<!-- **************** -->
<chapter>
    <title>Configuration</title>
    <para>The package can be configured via the SysConfig in the Admin Interface. The following configuration options are available:</para>
    <section>
        <title>PostMaster::PreFilterModule###1-SystemMonitoring.</title>
        <para>Group: SystemMonitoring, Subgroup: Core::PostMaster.</para>
        <para>Basic mail interface to System Monitoring Suites. Use this block if the filter should run AFTER PostMasterFilter.</para>
    </section>
    <section>
        <title>PostMaster::PreFilterModule###00-SystemMonitoring.</title>
        <para>Group: SystemMonitoring, Subgroup: Core::PostMaster.</para>
        <para>Basic mail interface to System Monitoring Suites. Use this block if the filter should run BEFORE PostMasterFilter.</para>
    </section>
    <section>
        <title>SystemMonitoring::SetIncidentState.</title>
        <para>Group: SystemMonitoring, Subgroup: Core::ConfigItem.</para>
        <para>Set the incident state of a CI automatically when a system monitoring email arrives.</para>
    </section>
    <section>
        <title>SystemMonitoring::LinkTicketWithCI.</title>
        <para>Group: SystemMonitoring, Subgroup: Core::ConfigItem.</para>
        <para>Link an already opened incident ticket with the affected CI. This is only possible when a subsequent system monitoring email arrives.</para>
    </section>
    <section>
        <title>Nagios::Acknowledge::FreeField::Host.</title>
        <para>Group: SystemMonitoring, Subgroup: Nagios::Acknowledge.</para>
        <para>Name of TicketFreeField for Host.</para>
    </section>
    <section>
        <title>Nagios::Acknowledge::FreeField::Service.</title>
        <para>Group: SystemMonitoring, Subgroup: Nagios::Acknowledge.</para>
        <para>Name of TicketFreeField for Service.</para>
    </section>
    <section>
        <title>Nagios::Acknowledge::Type.</title>
        <para>Group: SystemMonitoring, Subgroup: Nagios::Acknowledge.</para>
        <para>Define Nagios acknowledge type.</para>
    </section>
    <section>
        <title>Nagios::Acknowledge::NamedPipe::CMD.</title>
        <para>Group: SystemMonitoring, Subgroup: Nagios::Acknowledge.</para>
        <para>Named pipe acknowledge command.</para>
    </section>
    <section>
        <title>Nagios::Acknowledge::NamedPipe::Host.</title>
        <para>Group: SystemMonitoring, Subgroup: Nagios::Acknowledge.</para>
        <para>Named pipe acknowledge format for host.</para>
    </section>
    <section>
        <title>Nagios::Acknowledge::NamedPipe::Service.</title>
        <para>Group: SystemMonitoring, Subgroup: Nagios::Acknowledge.</para>
        <para>Named pipe acknowledge format for service.</para>
    </section>
    <section>
        <title>Ticket::EventModulePost###9-NagiosAcknowledge.</title>
        <para>Group: SystemMonitoring, Subgroup: Nagios::Acknowledge.</para>
        <para>Ticket event module to send an acknowlage to Nagios.</para>
    </section>
    <section>
        <title>Nagios::Acknowledge::HTTP::URL.</title>
        <para>Group: SystemMonitoring, Subgroup: Nagios::Acknowledge.</para>
        <para>The http acknowledge url.</para>
    </section>
    <section>
        <title>Nagios::Acknowledge::HTTP::User.</title>
        <para>Group: SystemMonitoring, Subgroup: Nagios::Acknowledge.</para>
        <para>The http acknowledge user.</para>
    </section>
    <section>
        <title>Nagios::Acknowledge::HTTP::Password.</title>
        <para>Group: SystemMonitoring, Subgroup: Nagios::Acknowledge.</para>
        <para>The http acknowledge password.</para>
    </section>
</chapter>

<!-- ******** -->
<!-- 6. Usage -->
<!-- ******** -->

<!--
<chapter>
    <title>Usage</title>
    <section>
        <title>Create Stats</title>
        <para>New stats can be sected as Dynamic or Static stats object.</para>
    </section>
</chapter>
-->

<!--
***************************************** Technical part ************************************
-->

<!-- ********************************* -->
<!-- 7. Technical Implementation Detail -->
<!-- ********************************* -->
<!--
<chapter>
    <title>Technical Implementation Details</title>
    <para>
        Technical Implementation Details.
    </para>
</chapter>
-->
<!-- *********** -->
<!-- 8. Filelist -->
<!-- *********** -->
<chapter>
    <title>File list</title>
    <para>This list shows all included files and the referring permissions.</para>
    <para>$Filelist</para>
</chapter>

<!-- ******* -->
<!-- 9. Test -->
<!-- ******* -->
<chapter>
    <title>Tests</title>
    <para>This module has been tested on the current state of the art in quality.</para>
    <section>
        <title>Test Cases</title>
        <para>
            To tests this package please follow the examples described in the Usage section, all the
            tests cases should return the expected results defined at the beginning of each example.
        </para>
    </section>
</chapter>

<!-- ************* -->
<!-- 10. Changelog -->
<!-- ************* -->
<chapter>
    <title>Change Log</title>
    <para>$ChangeLog</para>
</chapter>

<!-- ************ -->
<!-- 11. Contacts -->
<!-- ************ -->
<chapter>
    <title>Contacts</title>
    <para>People who are involved in this implementation.</para>
    <section>
        <title>OTRS AG</title>
        <para>
            Accounting: Rene Bakker
            <ulink url="mailto:sales@otrs.com?subject=$Name">
                &lt;sales@otrs.com&gt;
            </ulink>, Phone +49 (0)6172 681988 0
        </para>
        <para>
            Technical: Manuel Hecht
            <ulink url="mailto:dev-support@otrs.com?subject=$Name">
                &lt;dev-support@otrs.com&gt;
            </ulink>, Phone +49 (0)6172 681988 0
        </para>
    </section>
</chapter>

</book>
